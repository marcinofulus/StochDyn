    sage: # Przeskalowany potencjał bistabilny: a=b=1
    sage: p = plot(0.25*x^4 - 0.5*x^2, (x,-1.6,1.6), figsize=(6,4), axes_labels=[r'$x$',r'$V(x)$'], color="blue")
    sage: p += text("$-x_s$",(-1,0.025),fontsize=16, color='black')
    sage: p += text("$x_s$",(1,0.025),fontsize=16, color='black')
    sage: p.show()
    sage: 
    sage: #parametry dla wizualizacji
    sage: var('x v')
    sage: x0 = 1.5
    sage: v0 = 0.2
    sage: E = 0.25*x0^4 - 0.5*x0^2 + v0^2
    sage: #
    sage: #prawo zachowania energii
    sage: V=0.25*x^4 - 0.5*x^2
    sage: PZE = v^2 + V == E
    sage: #
    sage: #wychylenia ekstremalne
    sage: print "ekstremalne wychylenia dla (x0,v0) = (%.2f,%.2f)"%(x0,v0)
    sage: rozw = solve(PZE(v=0), x); show(rozw)
    sage: xmin = min([i.rhs() for i in rozw if imag(i.rhs()) == 0])
    sage: xmax = max([i.rhs() for i in rozw if imag(i.rhs()) == 0])
    sage: #
    sage: #i jego rozwiązanie
    sage: print "ekstremalne prędkości dla (x0,v0) = (%.2f,%.2f)"%(x0,v0)
    sage: rozw = solve(PZE, v); show(rozw)
    sage: v1=rozw[0].rhs()
    sage: v2=rozw[1].rhs()
    sage: vmax = abs(v1(x=0))
    sage: #
    sage: #krzywe fazowe
    sage: start_point = (x0,V(x=x0))
    sage: p0 = point(start_point,size=30) + text(r"$  x_0$",start_point,vertical_alignment='bottom',horizontal_alignment='left')
    sage: p1 = plot(V,(x,xmin,xmax))
    sage: p21 = plot(v1, (x,xmin,xmax), color='red')
    sage: p22 = plot(v2, (x,xmin,xmax), color='green')
    sage: (p0+p1).show(figsize=4)
    sage: (p21+p22).show(figsize=4)
    sage: 
    sage: 
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x v')
    sage: x01, v01 = 1.50, 0
    sage: x02, v02 = 1.52, 0
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.1
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,20*pi,0.01)
    sage: num1 = desolve_odeint(vector([v,F-g*v]), [x01,v01], T, [x,v])
    sage: num2 = desolve_odeint(vector([v,F-g*v]), [x02,v02], T, [x,v])
    sage: #
    sage: #krzywe fazowe
    sage: lt  = plot(V, (x, -max([abs(x01),abs(x02)]),max([abs(x01),abs(x02)])), color='black', figsize=4)
    sage: lt += point((x01,V(x=x01)), color='green', size=50, axes_labels=['$x$','$V(x)$'])
    sage: lt += point((x02,V(x=x02)), color='red', size=50)
    sage: lb  = list_plot(num1.tolist(), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'])
    sage: lb += list_plot(num2.tolist(), plotjoined=1, color='red', figsize=4)
    sage: rt  = list_plot(zip(T,num1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'])
    sage: rt += list_plot(zip(T,num2[:,0].tolist()), plotjoined=1, color='red', figsize=4)
    sage: rb  = list_plot(zip(T,num1[:,1].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$v(t)$'])
    sage: rb += list_plot(zip(T,num2[:,1].tolist()), plotjoined=1, color='red', figsize=4)
    sage: #
    sage: html("""
    sage: <p align='center'>rozwiązania z warunkami początkowymi
    sage: <span style="color:green">($x_{01},v_{01}$)=(%.2f,%.2f)</span>
    sage: <span style="color:red">($x_{02},v_{02}$)=(%.2f,%.2f)</span>
    sage: dążą do tego samego atraktora: 
    sage: (x,v)=(-1,0)
    sage: </p>
    sage: """%(x01,v01,x02,v02))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x v')
    sage: x01, v01 = 1.58, 0
    sage: x02, v02 = 1.57, 0
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.1
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,20*pi,0.01)
    sage: num1 = desolve_odeint(vector([v,F-g*v]), [x01,v01], T, [x,v])
    sage: num2 = desolve_odeint(vector([v,F-g*v]), [x02,v02], T, [x,v])
    sage: #
    sage: # wykresy funkcji
    sage: lt  = plot(V, (x, -max([abs(x01),abs(x02)]),max([abs(x01),abs(x02)])),color='black',  figsize=4)
    sage: lt += point((x01,V(x=x01)), color='blue', size=50, axes_labels=['$x$','$V(x)$'])
    sage: lt += point((x02,V(x=x02)), color='red', size=50)
    sage: lb  = list_plot(num1.tolist(), plotjoined=1, color='blue', axes_labels=['$x(t)$','$v(t)$'])
    sage: lb += list_plot(num2.tolist(), plotjoined=1, color='red', figsize=4)
    sage: rt  = list_plot(zip(T,num1[:,0].tolist()), plotjoined=1, color='blue', axes_labels=['$t$','$x(t)$'])
    sage: rt += list_plot(zip(T,num2[:,0].tolist()), plotjoined=1, color='red', figsize=4)
    sage: rb  = list_plot(zip(T,num1[:,1].tolist()), plotjoined=1, color='blue', axes_labels=['$t$','$v(t)$'])
    sage: rb += list_plot(zip(T,num2[:,1].tolist()), plotjoined=1, color='red', figsize=4)
    sage: #
    sage: html("""
    sage: <p align='center'>rozwiązania z warunkami początkowymi
    sage: <span style="color:blue">($x_{01},v_{01}$)=(%.2f,%.2f)</span>
    sage: <span style="color:red">($x_{02},v_{02}$)=(%.2f,%.2f)</span>
    sage: dążą do różnych atraktorów: 
    sage: <span style="color:blue">(x,v)=(1,0)</span>
    sage: <span style="color:red">(x,v)=(-1,0)</span>
    sage: </p>
    sage: """%(x01,v01,x02,v02))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: # przykładowa trajektoria  (górny wykres)
    sage: # wraz z krzywą fazową (dolny wykres)
    sage: var('x y z')
    sage: T = srange(0,150*pi,0.01)
    sage: sol=desolve_odeint( vector([y,x-x^3-0.26*y+0.3*cos(z), 1]), [0.1,0.1,0],T,[x,y,z])
    sage: t = line(zip(T,sol[:,0]), figsize=(12,4), axes_labels=["$t$","$x(t)$"], frame=1, axes=0)
    sage: b = line(zip(sol[:,0],sol[:,1]), figsize=(12,4), axes_labels=["$x(t)$","$v(t)$"], frame=1, axes=0)
    sage: html.table([[t],[b]])
    sage: 
    sage: 
    sage: 
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x0, y0, z0 = 0.1,0.1,0
    sage: kolor = 'green'
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.1
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,30*pi,0.01)
    sage: num = desolve_odeint(vector([dx,dy,dz]), [x0,y0,z0], T, [x,y,z])
    sage: #
    sage: # wykresy funkcji
    sage: xmin = 1.5
    sage: lt  = plot(V, (x,-xmin,xmin), figsize=4)
    sage: lt += point((x0,V(x=x0)), color=kolor, size=50, axes_labels=['$x$','$V(x)$'])
    sage: lb  = list_plot(zip(num[:,0],num[:,1]), plotjoined=1, color=kolor, axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: rt  = list_plot(zip(T,num[:,0].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb  = list_plot(zip(T,num[:,1].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$v(t)$'], figsize=4)
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z warunkami początkowymi
    sage: $(x_0,y_0,z_0) = (%.2f,%.2f,%.2f)$
    sage: """%(dx,dy,dz,x0,y0,z0))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: reset()
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x01, y01, z01 = 0.1,0.1,0
    sage: x02, y02, z02 = 0.11,0.1,0
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.1
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,200*pi,0.01)
    sage: num1 = desolve_odeint(vector([dx,dy,dz]), [x01,y01,z01], T, [x,y,z])
    sage: num2 = desolve_odeint(vector([dx,dy,dz]), [x02,y02,z02], T, [x,y,z])
    sage: #
    sage: lnum = int(len(num1[:,0])/10)
    sage: trans1 = num1[:lnum]
    sage: asymp1 = num1[-lnum:]
    sage: trans2 = num2[:lnum]
    sage: asymp2 = num2[-lnum:]
    sage: #
    sage: # wykresy funkcji
    sage: lt = list_plot(zip(trans1[:,0],trans1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lt += list_plot(zip(trans2[:,0],trans2[:,1]), plotjoined=1, color='red')
    sage: rt = list_plot(zip(T[:lnum],trans1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rt += list_plot(zip(T[:lnum],trans2[:,0].tolist()), plotjoined=1, color='red')
    sage: lb = list_plot(zip(asymp1[:,0],asymp1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lb += list_plot(zip(asymp2[:,0],asymp2[:,1]), plotjoined=0, color='red')
    sage: rb = list_plot(zip(T[-lnum:],asymp1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb += list_plot(zip(T[-lnum:],asymp2[:,0].tolist()), plotjoined=1, color='red')
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z różnymi warunkami początkowymi
    sage: <span style="color:green;">$(x_{01},y_{01},z_{01}) = (%.2f,%.2f,%.2f)$</span>
    sage: <span style="color:red;">$(x_{02},y_{02},z_{02}) = (%.2f,%.2f,%.2f)$</span>
    sage: """%(dx,dy,dz,x01,y01,z01,x02,y02,z02))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x0, y0, z0 = 0.1,0.1,0
    sage: kolor = 'red'
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.22
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,20*pi,0.01)
    sage: num = desolve_odeint(vector([dx,dy,dz]), [x0,y0,z0], T, [x,y,z])
    sage: #
    sage: # wykresy funkcji
    sage: xmin = 1.5
    sage: lt  = plot(V, (x,-xmin,xmin), figsize=4)
    sage: lt += point((x0,V(x=x0)), color=kolor, size=50, axes_labels=['$x$','$V(x)$'])
    sage: lb  = list_plot(zip(num[:,0],num[:,1]), plotjoined=1, color=kolor, axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: rt  = list_plot(zip(T,num[:,0].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb  = list_plot(zip(T,num[:,1].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$v(t)$'], figsize=4)
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z warunkami początkowymi
    sage: $(x_0,y_0,z_0) = (%.2f,%.2f,%.2f)$
    sage: """%(dx,dy,dz,x0,y0,z0))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: reset()
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x01, y01, z01 = 0.10,0.1,0
    sage: x02, y02, z02 = 0.11,0.1,0
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.22
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,200*pi,0.01)
    sage: num1 = desolve_odeint(vector([dx,dy,dz]), [x01,y01,z01], T, [x,y,z])
    sage: num2 = desolve_odeint(vector([dx,dy,dz]), [x02,y02,z02], T, [x,y,z])
    sage: #
    sage: lnum = int(len(num1[:,0])/10)
    sage: trans1 = num1[:lnum]
    sage: asymp1 = num1[-lnum:]
    sage: trans2 = num2[:lnum]
    sage: asymp2 = num2[-lnum:]
    sage: #
    sage: # wykresy funkcji
    sage: lt = list_plot(zip(trans1[:,0],trans1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lt += list_plot(zip(trans2[:,0],trans2[:,1]), plotjoined=1, color='red')
    sage: rt = list_plot(zip(T[:lnum],trans1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rt += list_plot(zip(T[:lnum],trans2[:,0].tolist()), plotjoined=1, color='red')
    sage: lb = list_plot(zip(asymp1[:,0],asymp1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lb += list_plot(zip(asymp2[:,0],asymp2[:,1]), plotjoined=0, color='red')
    sage: rb = list_plot(zip(T[-lnum:],asymp1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb += list_plot(zip(T[-lnum:],asymp2[:,0].tolist()), plotjoined=1, color='red')
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z różnymi warunkami początkowymi
    sage: <span style="color:green;">$(x_{01},y_{01},z_{01}) = (%.2f,%.2f,%.2f)$</span>
    sage: <span style="color:red;">$(x_{02},y_{02},z_{02}) = (%.2f,%.2f,%.2f)$</span>
    sage: """%(dx,dy,dz,x01,y01,z01,x02,y02,z02))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x0, y0, z0 = 0.1,0.1,0
    sage: kolor = 'firebrick'
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.25
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,50*pi,0.01)
    sage: num = desolve_odeint(vector([dx,dy,dz]), [x0,y0,z0], T, [x,y,z])
    sage: #
    sage: # wykresy funkcji
    sage: xmin = 1.5
    sage: lt  = plot(V, (x,-xmin,xmin), figsize=4)
    sage: lt += point((x0,V(x=x0)), color=kolor, size=50, axes_labels=['$x$','$V(x)$'])
    sage: lb  = list_plot(zip(num[:,0],num[:,1]), plotjoined=1, color=kolor, axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: rt  = list_plot(zip(T,num[:,0].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb  = list_plot(zip(T,num[:,1].tolist()), plotjoined=1, color=kolor, axes_labels=['$t$','$v(t)$'], figsize=4)
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z warunkami początkowymi
    sage: $(x_0,y_0,z_0) = (%.2f,%.2f,%.2f)$
    sage: """%(dx,dy,dz,x0,y0,z0))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: reset()
    sage: # wykresy dla przypadku z tłumieniem
    sage: var('x y z')
    sage: x01, y01, z01 = 0.1,0.1,0
    sage: x02, y02, z02 = 0.11,0.1,0
    sage: #
    sage: # siła
    sage: F = x-x^3
    sage: V = -integrate(F,x)
    sage: #
    sage: # tarcie: parametr gamma
    sage: g = 0.25
    sage: A = 0.3
    sage: w = 1
    sage: #
    sage: # układ różniczkowych równań ruchu
    sage: dx = y
    sage: dy = F - g*y + A*cos(z)
    sage: dz = w
    sage: #
    sage: # numeryczne rozwiazanie równań ruchu
    sage: T = srange(0,200*pi,0.01)
    sage: num1 = desolve_odeint(vector([dx,dy,dz]), [x01,y01,z01], T, [x,y,z])
    sage: num2 = desolve_odeint(vector([dx,dy,dz]), [x02,y02,z02], T, [x,y,z])
    sage: #
    sage: lnum = int(len(num1[:,0])/10)
    sage: trans1 = num1[:lnum]
    sage: asymp1 = num1[-lnum:]
    sage: trans2 = num2[:lnum]
    sage: asymp2 = num2[-lnum:]
    sage: #
    sage: # wykresy funkcji
    sage: lt = list_plot(zip(trans1[:,0],trans1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lt += list_plot(zip(trans2[:,0],trans2[:,1]), plotjoined=1, color='red')
    sage: rt = list_plot(zip(T[:lnum],trans1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rt += list_plot(zip(T[:lnum],trans2[:,0].tolist()), plotjoined=1, color='red')
    sage: lb = list_plot(zip(asymp1[:,0],asymp1[:,1]), plotjoined=1, color='green', axes_labels=['$x(t)$','$v(t)$'], figsize=4)
    sage: lb += list_plot(zip(asymp2[:,0],asymp2[:,1]), plotjoined=1, color='red')
    sage: rb = list_plot(zip(T[-lnum:],asymp1[:,0].tolist()), plotjoined=1, color='green', axes_labels=['$t$','$x(t)$'], figsize=4)
    sage: rb += list_plot(zip(T[-lnum:],asymp2[:,0].tolist()), plotjoined=1, color='red')
    sage: #
    sage: html("""Układ równań różniczkowych
    sage: $\dot{x} = %s$
    sage: $\dot{y} = %s$
    sage: $\dot{z} = %s$
    sage: z różnymi warunkami początkowymi
    sage: <span style="color:green;">$(x_{01},y_{01},z_{01}) = (%.2f,%.2f,%.2f)$</span>
    sage: <span style="color:red;">$(x_{02},y_{02},z_{02}) = (%.2f,%.2f,%.2f)$</span>
    sage: """%(dx,dy,dz,x01,y01,z01,x02,y02,z02))
    sage: html.table([[lt,rt],[lb,rb]])
    sage: 
    sage: 
    sage: 
    sage: 
    sage: 

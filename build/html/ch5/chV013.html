


  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Stochastyczne równania różniczkowe &mdash; Dynamika stochastyczna</title>
    
    <link rel="stylesheet" href="../_static/upgow.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono&subset=latin,latin-ext" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'I',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/jquery.min.js"></script>
	<script src="http://sagecell.icse.us.edu.pl:6363/static/embedded_sagecell.js"></script>
	
	<!-- <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script> -->
        <!--     <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script> -->

	<script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

	<style type="text/css">
		.sagecell .CodeMirror-scroll {
			overflow-y: hidden;
			overflow-x: auto;
		}
		.sagecell .CodeMirror {
			height: auto;
		}
	</style>

    
    <link rel="top" title="Dynamika stochastyczna" href="../index.html" />
    <link rel="next" title="Lapunov" href="chV014.html" />
    <link rel="prev" title="Równania różniczkowe zwyczajne" href="chV012.html" />
 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
  </head>
  <body>
  <div class="relbar-top">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Indeks ogólny"
             accesskey="I">indeks</a></li>
        <li class="right" >
          <a href="chV014.html" title="Lapunov"
             accesskey="N">dalej</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="chV012.html" title="Równania różniczkowe zwyczajne"
             accesskey="P">wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="../index.html">Dynamika stochastyczna</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="content">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="stochastyczne-rownania-rozniczkowe">
<h1>Stochastyczne równania różniczkowe<a class="headerlink" href="#stochastyczne-rownania-rozniczkowe" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<p>Stochastyczne równania różniczkowe (SDE, od angielskiej nazwy Stochastic differential equations)
są obecnie uważane za standardowe narzędzie wykorzystywane do analizy niektórych wielkości opisujących
dynamikę rynków finansowych. Do tych wielkości należą ceny aktywów, stopy procentowe czy ich pochodne.
W przeciwieństwie do zwyczajnych równań różniczkowych, które posiadają jendoznaczne rozwiązanie,
rozwiązaniami SDE są ciągłe w czasie procesy stochastyczne. Metody komputerowe wykorzystywane do analizy
SDE bazują na klasycznych metodach wykorzystywanych do rozwiązywania tradycyjnych, deterministycznych
równań różniczkowych, są jednak uogólnione tak, aby radzić sobie z procesami losowymi.</p>
<p>Zestaw zmiennych losowych <span class="math">\(X_t\)</span> indeksowanych liczbami rzeczywistymi <cite>t</cite> nazywamy procesem losowym
ciągłym (ze względu na czas). Każda <em>realizacja</em> procesu losowego to przypadkowa wartość zmiennej
losowej <span class="math">\(X_t\)</span> dla każdego <cite>t</cite>, jest więc funkcją czasu. Co ciekawe, <em>każda</em> deterministyczna
funkcja <span class="math">\(f(t)\)</span> może być uważana za proces stochastyczny, którego wariancja znika.</p>
<p>Najbardziej znanym przykładem procesu losowego szeroko występującego w modelach fizyki, chemii ale i
rynków finansowych jest <em>proces Wienera</em> <span class="math">\(W(t) = W_t\)</span>, ciągły proces stochastyczny posiadający
nastepujące własności</p>
<ol class="arabic simple">
<li>jest to proces rzeczywisty,</li>
<li>startuje z zera (<span class="math">\(W_0 = 0\)</span>),</li>
<li>ma stacjonarne i niezależne przyrosty na nieprzekrywających się przedziałach,</li>
<li>jest procesem Gaussa o zerowej wartości średniej <span class="math">\(\langle W_t - W_s \rangle = 0\)</span>
i wariancji przyrostów <span class="math">\(\langle [W_t - W_s]^2 \rangle = 2 D (t -s)\)</span>,</li>
<li>proces Wienera może być reprezentowany ciągłymi trajektoriami.</li>
</ol>
<p>Wynika z tego, że dla każdej różnicy czasów <cite>t - s</cite> zmienna losowa <span class="math">\(W_t - W_s\)</span> jest zmienną losową
gaussowską o zerowej wartości średniej i wariancji <span class="math">\(2D(t-s)\)</span>. Więc jego rozkład prawdopodobieństwa ma
postać</p>
<div class="math">
\[f_{W_t - W_s}(x) = \frac{1}{\sqrt{2 \pi D (t - s)}} \exp \Big[ -\frac{x^2}{4D(t-s)} \Big].\]</div>
<p>Proces taki może być wyprowadzony jako proces graniczny błądzenia przypadkowego. Wystarczy tylko zbadać
granicę dla której wielkość skoku i czas pomiędzy skokami będą maleć do zera. Tak zdefiniowanym procesem
posługujemy się zwyczajowo, gdy podczas analizy probalmu pojawia się jakaś nieregularna siła czy zaburzenie
którego nie możemy opisać równaniami deterministycznymi.</p>
<p>Typowe dla rynków finansowych <em>równanie dyfuzji</em> może być modelowane przez równanie różniczkowe posiadające
część deterministyczną zwaną <strong>dryftem</strong> oraz część losową zwaną <strong>dyfuzją</strong>. Ta ostatnia jest bardzo często
reprezentowana właśnie przez proces Wienera. Możemy sobie napisać ogólne równanie</p>
<div class="math">
\[dX = a(t, X) dt + b(t,X) dW_t.\]</div>
<p>Jest to postać różniczkowa. W zwykłych równaniach różniczkowych zazwyczaj stosujemu pochodne <span class="math">\(dx/dt\)</span>. W
tym przypadku postać różniczkowa ma większy sens, jako, że wiele interesujących nas procesów losowych (jak
ruch Browna) są procesami ciągłymi aczkolwiek nie są różniczkowalne. Powyższe równanie nabiera większego
sensu pod znakiem całki</p>
<div class="math">
\[X(t) = X(0) + \int_0^t a(s,y) ds \int_0^t b(s,y) dW_s.\]</div>
<p>Ostatni wyraz z prawej zwany jest całką Ito.</p>
<div class="section" id="rownanie-blacka-scholesa">
<h2>Równanie Blacka-Scholesa<a class="headerlink" href="#rownanie-blacka-scholesa" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Jednym z bardziej znanych, historycznym już równaniem stochastycznym, jest równanie opisujące geometryczny
ruch Browna</p>
<div class="math">
\[dX = \mu X dt + \sigma X dW_t,\]</div>
<p>gdzie <span class="math">\(\mu, \sigma\)</span> to wielkości stałe.
Równanie to jest jednym z podstawowych elementów modelu wyceny opcji Blacka-Scholesa. Teoria ta została
nagrodzona Nagrodą Nobla z ekonomii w roku 1997, a opracowana przez absolwenta fizyki i doktora matematyki
Fischera Blacka oraz ekonomistę Myrona Scholesa. Teoria Blacka-Scholesa pozwala na wycenę wartości tzw.
finansowych instrumentów pochodnych, czyli opcji, oraz służy do optymalizacji &#8220;bezpiecznego&#8221; portfela
inwestycyjnego.</p>
<p>Pomimo tego, że równanie to wygląda na proste, żeby nie powiedzieć zbyt proste na to by opisywać jakąkolwiek
rzeczywistość na rynkach finansowych, ma ono olbrzymie znaczenie, jako, że może być rozwiązane ściśle
dając wynikowy wzór z którego możemy wyliczyć zmianę cen prostych opcji. Jak już powiedzieliśmy,
rozwiązanie jest geometrycznym ruchem Browna</p>
<div class="math">
\[X(t) = X_0 \exp \Big[ \Big( \mu - \frac{\sigma^2}{2} \Big) t + \sigma dW_t \Big].\]</div>
<p>Dzięki zamkniętej postaci rozwiązania mamy możliwość testowania metod numerycznych, które przedstawimy
poniżej.</p>
</div>
<div class="section" id="schemat-eulera-maruyamy">
<h2>Schemat Eulera-Maruyamy<a class="headerlink" href="#schemat-eulera-maruyamy" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Najprostszą metodą numerycznego rozwiązywania równań różniczkowych zwyczajnych jest metoda Eulera. Bazuje
ona np. na rozwinięciu Tylora w pierwszym rzędzie przybliżenia. Stochastycznym analogiem tej metody
jest metoda Eulera-Maruyamy.</p>
<p>Będziemy chcieli podać przybliżone rozwiązanie ogólnej postaci SDE na przedziale czasowym
<span class="math">\(t \in [t_0,t_E]\)</span>. Na początku zdyskretyzujemy sobie ów przedział czasowy, ustalając na siatkę
<cite>N</cite> punktów</p>
<div class="math">
\[\begin{split}t_0 &lt; t_1 &lt; t_2 &lt; \dots &lt; t_{N-2} &lt; t_E.\end{split}\]</div>
<p>Dążymy do tego, aby na tej siatce znaleźć przybliżone wartości zmiennej <span class="math">\(X\)</span>. Oznaczmy je</p>
<div class="math">
\[\begin{split}w_0 &lt; w_1 &lt; w_2&lt; \dots &lt; w_{N-2} &lt; w_E.\end{split}\]</div>
<p>Są to oczywiście przybliżone rozwiązania zmiennej <span class="math">\(x\)</span> dla odpowiednich czasów z powyższej siatki
<span class="math">\(\{t_i\}\)</span>. Zakładając wartość początkową dla SDE <span class="math">\(X(t_0) = X_0\)</span> możemy pokusić się
o rozwiązanie numeryczne w następującej postaci</p>
<div class="math">
\[w_0 = X_0\]\[w_{i+1} = w_i + a (t_i, w_i) \Delta t_{i+1} + b(t_i, w_i) \Delta W_{i+1}\]\[\Delta t_{i+1} = t_{i+1} - t_i\]\[\Delta W_{i+1} = W(t_{i+1}) - W(t_i).\]</div>
<p>Kluczową sprawą w tym punkcie jest problem: jak zamodelować <span class="math">\(\Delta W_i\)</span>? Mając do dyspozycji generator
liczb losowych z rozkładem <cite>N(0,1)</cite> każdą losową liczbę <span class="math">\(\Delta W_i\)</span> obliczamy ze wzoru</p>
<div class="math">
\[\Delta W_i = \sqrt{\Delta t_i} z_i,\]</div>
<p>gdzie <span class="math">\(z_i\)</span> jest losowana właśnie z <cite>N(0,1)</cite>.
Aby scałkować proces stochastyczny użyjemy formuły na przyrost procesu Wienera</p>
<div class="math">
\[\int_{t_i}^{t_{i+1}} \Gamma(t) dt =
\int_{t_i}^{t_{i+1}} dW(t) =  W(t_{i+1}) - W(t_i)\]</div>
<p>Z definicji procesu Wienera wiemy, że jest on procesem Gaussa o zerowej średniej i wariancji liniowej w czasie
<span class="math">\(\langle [W(t_{i+1}) - W(t_i)]^2 \rangle = 2 D \Delta t_i\)</span>, co daje nam w sensie średnio-kwadratowym
<span class="math">\(\Delta W \propto \sqrt{\langle [\Delta W (t)]^2 \rangle} = \sqrt{\Delta t_i}\)</span>. Scałkowanie procesu Wienera
prowadzi do</p>
<div class="math">
\[\int_{t_i}^{t_{i + 1}} dW_t = \sqrt{\Delta t_i} z_i.\]</div>
<p>Jeżeli założymy sobie, że krok czasowy (odległości na siatce rozwiązań) jest stały i wynosi
<span class="math">\(\Delta t_i = h\)</span> możemy napisać schemat explicite</p>
<div class="math">
\[w_{i+1} = w_i + h a(t_i, w_i) + \sqrt{h} b(t_i, w_i) z_i.\]</div>
<p>Jako, że każdy zestaw wartości <span class="math">\(\{w_i\}, i=0,\dots,E\)</span> wyprodukowany przez powyższą formułę
będzie przybliżonym rozwiązaniem procesu losowego, to i każda realizacja (każdy zestaw) będzie
również losowa, a co za tym idzie - każda realizacja procesu będzie inna.</p>
</div>
<div class="section" id="schemat-millsteina">
<h2>Schemat Millsteina<a class="headerlink" href="#schemat-millsteina" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Dodaje on poprawkę do poprzedniego rozwiązania, powodując, że schemat staje się schematem pierwszego rzędu
w sensie silnym. Dany jest on wzorem iteracyjnym</p>
<div class="math">
\[w_0 = X_0\]\[w_{i+1} = w_i + a(w_i,t_i) h -
\frac{h}{2} b(x_i,t_i)\frac{\partial b}{\partial x}'(w_i,t_i)(z_i^2 - 1) +
\sqrt{h} b(w_i,t_i) z_i.\]</div>
<p>Obie metody (Millsteina i Eulera-Maruyamy) redukują się do tego samego schematu gdy część losowa nie jest
zależna od zmiennej <cite>x</cite>. Jeżeli zależność istnieje, schemat Millsteina będzie szybciej zbieżny od
schematu EM.</p>
</div>
</div>
<div class="section" id="przyklady-calkowania-procesow-stochastycznych">
<h1>Przykłady całkowania procesów stochastycznych<a class="headerlink" href="#przyklady-calkowania-procesow-stochastycznych" title="Stały odnośnik do tego nagłówka">¶</a></h1>
<div class="section" id="proces-dyfuzji">
<h2>Proces dyfuzji<a class="headerlink" href="#proces-dyfuzji" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Jest to prawdopodobnie najprostszy proces stochastyczny wykorzystujący biały szum
gaussowski jako proces losowy. Przez matematyków nazywany jest po prostu procesem
Wienera ponieważ prawa strona równania ruchu zawiera tylko i wyłącznie ów proces.
Z drugiej strony jest obok procesu Poissona najważniejszym procesem losowym
na bazie którego można zdefiniować całą rodzinę procesów losowych o ciągłych
realizacjach. Równanie to można przedstawić używając równania Ito</p>
<div class="math">
\[d x(t) = \sqrt{2 D} dW(t).\]</div>
<p>Realizacja jest funkcją ciągłą, ale nigdzie nieróżniczkowalną (jako że pochodna
procesu Wienera nie istnieje). Za pomocą znanego już schematu Eulera-Maruyamy (EM)
możemy sobie wygenerować pojedynczą realizację takiego procesu. Parametr <span class="math">\(D\)</span>
reguluje natężenie szumu.</p>
<div class="math">
\[x_0 = 0\]\[x_{i+1} = x_i + \sqrt{2 h D} N(0,1).\]</div>
<p>Wiemy, że dla
procesu Wienera <span class="math">\(W(0) = 0\)</span>, wystartujemy więc z <span class="math">\(x(0) = 0\)</span>. Weźmy
krok <span class="math">\(h=0.01\)</span> i 5000 kroków czasowych. Dla przejrzystości weźmiemy
natężenie szumu <span class="math">\(D=1\)</span>. Jako, że wiemy jak generować zmienne z rozkładem
<cite>N(0,1)</cite> użyjemy sobie &#8220;symbolicznego&#8221; oznaczenia na funkcję zwracajacą
takie zmienne. Funkcję taką nazwiemy <tt class="docutils literal"><span class="pre">std_norm</span></tt>. Konkretna realizacja
takiej funkcji może odbywać np: poprzez algorytm Boxa-Mullera. Funkcja ta
będzie przy wywołaniu zwracała jedną liczbę losową z <cite>N(0,1)</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
  <span class="n">n01</span> <span class="o">=</span> <span class="n">std_norm</span><span class="p">()</span>
  <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">D</span><span class="p">)</span> <span class="o">*</span> <span class="n">n01</span><span class="p">)</span>
</pre></div>
</div>
<p>Teraz narysujmy sobie takie realizacje dla kilku różnych wartości parametru <cite>D</cite>.</p>
<div class="figure align-center">
<img alt="Proces dyfuzji dla kilku różnych wartości parametru D." src="../_images/dyf02.png" />
<p class="caption">Proces dyfuzji dla kilku różnych wartości parametru D.</p>
</div>
<p>Na pierwszy rzut oka trajektorie (czy realizacje, przebiegi...) wyglądają kompletnie
inaczej. Dla małych wartości <cite>D</cite> krzywe są bardziej regularne niż dla tych
parametryzowanych przez większe wartości <cite>D</cite>, dla których to wykres jest mocno
poszarpany i nieregularny. Jeżeli jednak narysowalibyśmy je osobno, nie oznaczając
osi, identyfikacja byłaby niemożliwa - nie widzimy bowiem relacji pomiędzy
wartościami (przyrostami).</p>
<div class="figure align-center">
<img alt="Proces dyfuzji dla kilku różnych wartości parametru D." src="../_images/dyf.png" />
<p class="caption">Proces dyfuzji dla kilku różnych wartości parametru D. Są to te same przebiegi co
w poprzednim wykresie. Kolory tu uzyte odpowiadają kolorom z wykresu poprzedniego.</p>
</div>
<p>Jako, że rozwiązanie równania dyfuzji znane jest od dawoen dawna, możemy potestować
na ile dokładnie rozwiązujemy nasze równanie. Oczywiście jedyne co możemy określić,
to rozkład gęstości prawdopodobieństwa. Zakładając warunki początkowe</p>
<div class="math">
\[P(x,0) = \delta (x)\]</div>
<p>co oznacza, że cały zespół cząstek podlegających dyfuzji wystartuje z <span class="math">\(x(0)=0\)</span>,
możemy podać odpowiedź, bazując na równaniu dyfuzji</p>
<div class="math">
\[\frac{\partial P(x,t)}{\partial t} = D\frac{\partial^2 P(x,t)}{\partial x^2}.\]</div>
<p>Wynikiem jest rozkład Gaussa postaci</p>
<div class="math">
\[P(x,t) = \frac{1}{\sqrt{4 \pi D t}} \exp \Big[ -\frac{x^2}{4 D t} \Big].\]</div>
<p>w którym wariancja rośnie liniowo z czasem a średnia jest równa zero. Zobaczmy, czy jesteśmy w
stanie zweryfikować powyższy wzór numerycznie. Postaramy się znaleźć histogram
pozycji 10000 cząstek po 100 krokach i porównamy go z powyższym wynikiem. Założymy sobie
<span class="math">\(D=0.1\)</span> i krok czasowy <span class="math">\(h=0.01\)</span>. Oznacza to, że po 100 krokach symulacji
osiągniemy rzeczywisty czas równy 1.</p>
<div class="figure align-center">
<img alt="Proces dyfuzji po 100 krokach symulacji." src="../_images/dyf_100n.png" />
<p class="caption">Proces dyfuzji po 100 krokach symulacji dla <span class="math">\(D=0.1\)</span>, <span class="math">\(h=0.01\)</span>, <span class="math">\(N=100\)</span>
a co za tym idzie <span class="math">\(t=Nh\)</span>.</p>
</div>
<dl class="docutils">
<dt>Zadanie 6.1.1</dt>
<dd>Wykonaj w Sage powyższy rysunek. Metodę generowania histogramów znajdziesz w pierwszej
części skryptu. Listę położeń, którą należy podać do histogramu wygeneruj w podobny
sposób jak na początku tego rozdziału.</dd>
</dl>
</div>
<div class="section" id="dyfuzja-ze-stalym-dryftem">
<h2>Dyfuzja ze stałym dryftem<a class="headerlink" href="#dyfuzja-ze-stalym-dryftem" title="Stały odnośnik do tego nagłówka">¶</a></h2>
<p>Proces taki otrzymuje się bezpośrednio jako graniczny przypadek niesymetrycznego błądzenia
przypadkowego (polecam poczytać <a class="reference external" href="http://el.us.edu.pl/ekonofizyka/index.php/PIZL:Proces_Wienera_i_proces_dyfuzji#Przypadek_niesymetryczny:_dyfuzja_z_dryfem">ten podrozdział</a>).
Równanie opisujące ten proces ma postać zbliżoną do poprzedniego, bogatsze jest jednak
o dodatkowy czynnik, zwany dryftem</p>
<div class="math">
\[\frac{\partial P(x,t)}{\partial t} = -V\frac{\partial P(x,t)}{\partial x} + D\frac{\partial^2 P(x,t)}{\partial x^2}.\]</div>
<p>Rozwiązaniem równania dyfuzji z dryfem, z takim samym warunkiem początkowym jak poprzednio
(wszystkie cząstki, bądź realizacje zaczynają z tego samego położenia <span class="math">\(x(0)=0\)</span>
jest następujaca funkcja</p>
<div class="math">
\[P(x,t) = \frac{1}{\sqrt{4 \pi D t}} \exp \Big[ -\frac{(x - Vt)^2}{4 D t} \Big].\]</div>
<p>Jest to funkcja Gaussa opisujaca zmienne losowe normalne, a dwa pierwsze momenty wynoszą
odpowiednio <span class="math">\(\xi(t) = Vt\)</span> oraz <span class="math">\(\sigma_{\xi}^2 = 2 D t\)</span>. Łatwo zauważyć, że
zarówno średnia jak i wariancja zależne są liniowo od czasu. Ponadto wariancja jest
identyczna jak w procesie dyfuzji bez dryftu. Dryft ów stały można z punktu widzenia fizyki
rozumieć jako stałą siłę przyłożoną do cząstki (coś na kształt cząstki umieszczonej na
równi pochyłej) - położenie cząstki rośnie liniowo z czasem (jak w ruchu jednostajnie
prostoliniowym), ale fluktuacje rosną w czasie jak pierwiastek <span class="math">\(\sqrt{t}\)</span>.</p>
<p>Podobną analizę numeryczną jak poprzednio możemy przeprowadzić i tutaj. Tym razem, wykreślimy
sobie stroboskopowo histogram położeń po kilku krokach: <cite>N = 10, 100, 200</cite>. Po lekkiej
modyfikacji numeryczny schemat EM będzie wyglądał tak</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">V</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
  <span class="n">n01</span> <span class="o">=</span> <span class="n">std_norm</span><span class="p">()</span>
  <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">D</span><span class="p">)</span> <span class="o">*</span> <span class="n">n01</span><span class="p">)</span>
</pre></div>
</div>
<p>Teraz wystarczy zobaczyć, czy histogramy położeń po czasie <cite>t=0.1, 1, 2</cite> będą odpowiadały
obliczonej powyżej funkcji rozkładu.</p>
<div class="figure align-center">
<img alt="Proces dyfuzji z dryftem po 10, 100 i 200 krokach symulacji." src="../_images/dryftdif001.png" />
<p class="caption">Proces dyfuzji ze stałym dryftem po 10, 100 i 200 krokach symulacji dla <span class="math">\(D=0.1\)</span>,
<span class="math">\(h=0.01\)</span>, a co za tym idzie <span class="math">\(t=0.1, 1, 2\)</span>.</p>
</div>
<p>Możemy policzyć sobie teraz średnie, odchylenie standardowe oraz błędy względny i bezwzględny
przybliżeń dokładnych rozwiązań procesu dyfuzji z dryftem.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="13%" />
<col width="11%" />
<col width="17%" />
<col width="21%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">czas</th>
<th class="head">&nbsp;</th>
<th class="head">teoria</th>
<th class="head">symulacje</th>
<th class="head"><span class="math">\(E_b\)</span></th>
<th class="head"><span class="math">\(E_w\)</span> [%]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="2">t=0.1</td>
<td>średnia</td>
<td>0.10</td>
<td>0.09972</td>
<td>0.0002766</td>
<td>0.2766</td>
</tr>
<tr class="row-odd"><td>std</td>
<td>0.1414</td>
<td>0.1413</td>
<td>0.00007544</td>
<td>0.05335</td>
</tr>
<tr class="row-even"><td rowspan="2">t=1</td>
<td>średnia</td>
<td>1.0</td>
<td>1.005</td>
<td>0.005345</td>
<td>0.5345</td>
</tr>
<tr class="row-odd"><td>std</td>
<td>0.4472</td>
<td>0.444</td>
<td>0.003026</td>
<td>0.6766</td>
</tr>
<tr class="row-even"><td rowspan="2">t=2</td>
<td>średnia</td>
<td>2.0</td>
<td>2.001</td>
<td>0.001460</td>
<td>0.07302</td>
</tr>
<tr class="row-odd"><td>std</td>
<td>0.6324</td>
<td>0.6362</td>
<td>0.003708</td>
<td>0.5863</td>
</tr>
</tbody>
</table>
<p>Jak widzimy błędy bezwzględne dochodzą do około pół punktu procentowego różnicy dla 10000
realizacji. Zwiekszenie próby spowoduje jeszcze lepsze dopasowanie, zmniejszenie spowoduje
większe odchylenia od wartości rzeczywistych.</p>
<dl class="docutils">
<dt>Zadanie 6.1.2</dt>
<dd>Oblicz błędy przybliżenia rozwiazania problemu dyfuzji ze stałym dryftem dla 10, 100, 500 i
1000 różnych realizacji. Zestawienia podaj w tabeli.</dd>
</dl>
</div>
<div class="section" id="proces-ornsteina-uhlenbecka">
<h2>Proces Ornsteina-Uhlenbecka<a class="headerlink" href="#proces-ornsteina-uhlenbecka" title="Stały odnośnik do tego nagłówka">¶</a></h2>
</div>
<div class="section" id="id1">
<h2>Równanie Blacka-Scholesa<a class="headerlink" href="#id1" title="Stały odnośnik do tego nagłówka">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxlocaltoc">
  <h3><a href="../index.html">Spis treści</a></h3>
  <ul>
<li><a class="reference internal" href="#">Stochastyczne równania różniczkowe</a><ul>
<li><a class="reference internal" href="#rownanie-blacka-scholesa">Równanie Blacka-Scholesa</a></li>
<li><a class="reference internal" href="#schemat-eulera-maruyamy">Schemat Eulera-Maruyamy</a></li>
<li><a class="reference internal" href="#schemat-millsteina">Schemat Millsteina</a></li>
</ul>
</li>
<li><a class="reference internal" href="#przyklady-calkowania-procesow-stochastycznych">Przykłady całkowania procesów stochastycznych</a><ul>
<li><a class="reference internal" href="#proces-dyfuzji">Proces dyfuzji</a></li>
<li><a class="reference internal" href="#dyfuzja-ze-stalym-dryftem">Dyfuzja ze stałym dryftem</a></li>
<li><a class="reference internal" href="#proces-ornsteina-uhlenbecka">Proces Ornsteina-Uhlenbecka</a></li>
<li><a class="reference internal" href="#id1">Równanie Blacka-Scholesa</a></li>
</ul>
</li>
</ul>

  </div>
  <h4>Poprzedni temat</h4>
  <p class="topless"><a href="chV012.html"
                        title="poprzedni rozdział">Równania różniczkowe zwyczajne</a></p>
  <h4>Następny temat</h4>
  <p class="topless"><a href="chV014.html"
                        title="następny rozdział">Lapunov</a></p>
  <h3>Ta strona</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/ch5/chV013.txt"
           rel="nofollow">Pokaż źródło</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Szybkie wyszukiwanie</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Szukaj" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Wprowadź szukany termin lub nazwę modułu, klasy lub funkcji.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
  <div class="relbar-bottom">
    
    <div class="related">
      <h3>Nawigacja</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Indeks ogólny"
             >indeks</a></li>
        <li class="right" >
          <a href="chV014.html" title="Lapunov"
             >dalej</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="chV012.html" title="Równania różniczkowe zwyczajne"
             >wstecz</a> &nbsp; &nbsp;</li>
  <li><a href="../index.html">Dynamika stochastyczna</a> &raquo;</li>
   
      </ul>
    </div>
  </div>
  
  <div class="footer">
    <a class="logo" href="http://upgow.us.edu.pl/" target="_blank"><img src="_static/upgow.png" alt="UPGOW"/></a><br/>
    &copy; Copyright 2013, Jerzy Łuczka, Łukasz Machura.
    Ostatnia modyfikacja Nov 07, 2013.
    Utworzone przy pomocy <a href="http://sphinx.pocoo.org/">Sphinx</a>'a 1.1.3.
  </div>
  </body>
</html>